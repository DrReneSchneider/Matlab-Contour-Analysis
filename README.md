# Matlab-Contour-Analysis
Matlab scripts to analyze the distribution of microtubules in cotelydon pavement cells of Arabidopsis thaliana as used by Eng et al., Current Biology, 2021 (https://www.sciencedirect.com/science/article/pii/S0960982221006783) and by Schneider et al., Nature Plants, 2022 (https://www.nature.com/articles/s41477-022-01218-7).

These scripts were used to analyze the distribution of microtubules (mCHERRY-TUA5) relative to the plasma membrane (LIi6B-GFP) of cotelydon pavement cells. Two input files are needed for the analysis:
a) A TIF (16-bit) image of the microtubules at the cell surface. To extract surface information of the microtubules, we used maximum intensity projections (or smooth manifold projections) to reduce the z-stack recordings to single-plane images.
b) A TIF (16-bit) image of the cell outlines. To extract cell outlines, we used maximum intensity projections of the LTi6B-GFP signals (z-stacks) and manually curated the images to recude background.

Script A imports the input files, segments them using the Matlab in-built watershed function, and allows the selection, rejection, and curation of cell outlines via a GUI. Several outputs allow the analysis to be fully supervised. Outputs comprise:
- input images (files with A_[...] and B_[...])
- watershed results (raw and after curation; files E_[...] and F_[...])
- watershed image overlayed with microtubules and plasma membranes (files B_[...] and D_[...])
- indexed map of selected cells (G_[...])
- TXT file containing the x-y-coordinates of all selected cell outlines (Cell_Contours_[...])
- Matlab summary file: workspace_Contours.mat (needed for further analysis)

Script B imports the workspace_Contours.mat file (generated by script A) and performs a contour analysis by measuring various microtubule- and cell shape-related parameters (e.g. by using the code of Fibril Tool published previously; Arezki Boudaoud et al., Nature Protocols, 2014, and the concept of the largest empty circle from Sapala et al., eLife, 2018) and correlating them to the curvature of each respective cell. A critical parameters that can be modified by the user is the MARGIN size, i.e. the size of the local analysis window that is used to measure the above parameters along the contour of the cell. Outputs are:
- folders with single-cell and ensemble TIF images:
    - microtubule intensity margin plotted along contour (H_Cell_[...]Contours&MTs.TIF)
    - microtubule intensity averages plotted along contour (I_Cell_[...]Contours_meanIntensity.TIF)
    - curvature plotted against contour (J_Cell_[...]Contours_meanCurvature.TIF; 0-curvature = 1; negative curvatures = concave)
    - local microtubule anisotropy plotted along contour (K_Cell_[...]Contours_meanAnisotropy.TIF, 0-anisotropy = 1)
    - local microtubule orientation plotted along contour (L_Cell_[...]Contours_meanOrientation.TIF, parallel to contour = 1000, normal to contour = 2000)
    - JPEG containing distribution of curvature and microtubule intensity, and scatter plots and linear regression results of both, M_[...]Curv_vs_Intensity_EachCell)
    - local largest empty circle (LEC) plotted along contour (N_Cell_[...]Contours_localLEC.TIF, pixel values code for LEC radius in pixels)
    - local microtubule anisotropy (component normal to contour) plotted along contour (O_Cell_[...]Contours_Aniso_Norm.TIF, 0-anisotropy = 1)
- TXT file containing all single-cell measurements taken for all selected cells (area, perimeter, lobeyness, mean microtubule intensity-vs-curvature gradients and correlation coefficients, mean curvature, mean microtubule anisotropy, mean microtubule orientation, mean LEC, and mean anisotropy normal to contour)
- TXT file containing pooled information on mean microtubule intensity (+sd, sem) plotted against curvature for all cells (curvature bins = 0.02 from -0.4 to +1.0)
- density diagram (Q_ALL_[...]C-I-Heatmap.TIF) and scatter plot (P_ALL_[...]Curv_Intensity_AllCells.TIF) of pooled information on mean microtubule intensity plotted against curvature for all cells
- Matlab summary file: workspace_Analysis.mat

In case of question, please do not hesitate to contact:
sampathkumar@mpimp-golm.mpg.de, rschneider@mpimp-golm.mpg.de, reng@mpipz.mpg.de
